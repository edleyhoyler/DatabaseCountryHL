CREATE PROCEDURE [dbo].[COUNTRY_CRUD]
	@COU_ID              INT          = NULL,
	@CON_ID              INT          = NULL,
	@COU_NAME_EN         VARCHAR(100) = NULL,
	@COU_NAME_BR         VARCHAR(100) = NULL,
	@COU_ISO31661_ALPHA2  CHAR(2)      = NULL,
	@COU_ISO31661_ALPHA3  CHAR(3)      = NULL,
	@COU_ISO31661_NUMBER INT          = NULL,
	@CRUD                VARCHAR(6)   = NULL,
	@RESULT              VARCHAR(7)   = NULL OUTPUT
AS
BEGIN
	SET NOCOUNT ON;
	SET @RESULT = ('ERROR');
	BEGIN TRY
		DECLARE @TRANSACTION_COUNTRY_CRUD CHAR(24) = ('TRANSACTION_COUNTRY_CRUD'); 
		BEGIN TRANSACTION @TRANSACTION_COUNTRY_CRUD;
		IF (@CRUD IS NOT NULL) 
		BEGIN
			EXECUTE [dbo].[CRUD_LIST_ARRAY_ONLY];
			IF ((UPPER(@CRUD)) = (SELECT (UPPER([C].[CRUD_NAME])) FROM [dbo].[##CRUD_LIST_ARRAY_ONLY] AS [C] WHERE (UPPER([C].[CRUD_NAME])) = (UPPER(@CRUD))))
			BEGIN
				PRINT (UPPER(@CRUD));
				IF (@CRUD = (UPPER('insert')))
				BEGIN
					IF (
							(@CON_ID IS NOT NULL) 
							AND 
							(@COU_NAME_EN IS NOT NULL) 
							AND 
							(@COU_NAME_BR IS NOT NULL) 
							AND 
							(@COU_ISO31661_ALPHA2 IS NOT NULL)
							AND 
							(@COU_ISO31661_ALPHA3 IS NOT NULL) 
							AND 
							(@COU_ISO31661_NUMBER IS NOT NULL)
						)
					BEGIN
						INSERT INTO [dbo].[COUNTRY]
						(   
							[CON_ID],
							[COU_NAME_EN],
							[COU_NAME_BR],
							[COU_ISO31661_ALPHA2],
							[COU_ISO31661_ALPHA3],
							[COU_ISO31661_NUMBER]
						)
						VALUES
						(
							@CON_ID,
							@COU_NAME_EN,
							@COU_NAME_BR,
							@COU_ISO31661_ALPHA2,
							@COU_ISO31661_ALPHA3,
							@COU_ISO31661_NUMBER
						);
					END
				ELSE
					BEGIN
						PRINT ('ERRO INSERT NULL COD.0004');
						RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO INSERT NULLCOD.0004') WITH LOG;
					END;
				END
				ELSE IF (@CRUD = (UPPER('select')))
				BEGIN
					IF (@COU_ID IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM
							[dbo].[COUNTRY] AS [C]
						WHERE 
							[C].[COU_ID] = (@COU_ID);
					END
					ELSE IF (@CON_ID IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM 
							[dbo].[COUNTRY] AS [C]
						WHERE
							[C].[CON_ID] = (@CON_ID);
					END
					ELSE IF (@COU_NAME_EN IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM 
							[dbo].[COUNTRY] AS [C]
						WHERE 
							[C].[COU_NAME_EN] = (@COU_NAME_EN);
					END
					ELSE IF (@COU_NAME_BR IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM 
							[dbo].[COUNTRY] AS [C]
						WHERE 
							[C].[COU_NAME_BR] = (@COU_NAME_BR);
					END
					ELSE IF (@COU_ISO31661_ALPHA2 IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM 
							[dbo].[COUNTRY] AS [C]
						WHERE 
							[C].[COU_ISO31661_ALPHA2] = (@COU_ISO31661_ALPHA2);
					END
					ELSE IF (@COU_ISO31661_ALPHA3 IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM 
							[dbo].[COUNTRY] AS [C]
						WHERE 
							[C].[COU_ISO31661_ALPHA3] = (@COU_ISO31661_ALPHA3);
					END
					ELSE IF (@COU_ISO31661_NUMBER IS NOT NULL)
					BEGIN
						SELECT 
							[C].[COU_ID], 
							[C].[CON_ID],
							[C].[COU_NAME_EN],
							[C].[COU_NAME_BR],
							[C].[COU_ISO31661_ALPHA2],
							[C].[COU_ISO31661_ALPHA3],
							[C].[COU_ISO31661_NUMBER]
						FROM 
							[dbo].[COUNTRY] AS [C]
						WHERE 
							[C].[COU_ISO31661_NUMBER] = (@COU_ISO31661_NUMBER);
					END
					ELSE
					BEGIN
						PRINT ('ERRO SELECT NULL COD.0005');
						RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO SELECT NULL COD.0005') WITH LOG;
					END;
				END
				ELSE IF (@CRUD = (UPPER('update')))
				BEGIN
					IF (@CON_ID IS NOT NULL)
					BEGIN
						UPDATE [dbo].[COUNTRY] 
						SET 
							[CON_ID]				= @CON_ID, 
							[COU_NAME_EN]			= @COU_NAME_EN,
							[COU_NAME_BR]			= @COU_NAME_BR,
							[COU_ISO31661_ALPHA2]	= @COU_ISO31661_ALPHA2,
							[COU_ISO31661_ALPHA3]	= @COU_ISO31661_ALPHA3,
							[COU_ISO31661_NUMBER]	= @COU_ISO31661_NUMBER
						WHERE [CON_ID] = (@CON_ID); 
					END
					ELSE IF (@COU_NAME_EN IS NOT NULL)
					BEGIN
						UPDATE [dbo].[COUNTRY] 
						SET 
							[CON_ID]				= @CON_ID, 
							[COU_NAME_EN]			= @COU_NAME_EN,
							[COU_NAME_BR]			= @COU_NAME_BR,
							[COU_ISO31661_ALPHA2]	= @COU_ISO31661_ALPHA2,
							[COU_ISO31661_ALPHA3]	= @COU_ISO31661_ALPHA3,
							[COU_ISO31661_NUMBER]	= @COU_ISO31661_NUMBER
						WHERE [COU_NAME_EN] = (@COU_NAME_EN); 
					END
					ELSE IF (@COU_NAME_BR IS NOT NULL)
					BEGIN
						UPDATE [dbo].[COUNTRY] 
						SET 
							[CON_ID]				= @CON_ID, 
							[COU_NAME_EN]			= @COU_NAME_EN,
							[COU_NAME_BR]			= @COU_NAME_BR,
							[COU_ISO31661_ALPHA2]	= @COU_ISO31661_ALPHA2,
							[COU_ISO31661_ALPHA3]	= @COU_ISO31661_ALPHA3,
							[COU_ISO31661_NUMBER]	= @COU_ISO31661_NUMBER
						WHERE [COU_NAME_BR] = (@COU_NAME_BR); 
					END
					ELSE IF (@COU_ISO31661_ALPHA2 IS NOT NULL)
					BEGIN
						UPDATE [dbo].[COUNTRY] 
						SET 
							[CON_ID]				= @CON_ID, 
							[COU_NAME_EN]			= @COU_NAME_EN,
							[COU_NAME_BR]			= @COU_NAME_BR,
							[COU_ISO31661_ALPHA2]	= @COU_ISO31661_ALPHA2,
							[COU_ISO31661_ALPHA3]	= @COU_ISO31661_ALPHA3,
							[COU_ISO31661_NUMBER]	= @COU_ISO31661_NUMBER
						WHERE [COU_ISO31661_ALPHA2] = (@COU_ISO31661_ALPHA2); 
					END
					ELSE IF (@COU_ISO31661_ALPHA3 IS NOT NULL)
					BEGIN
						UPDATE [dbo].[COUNTRY] 
						SET 
							[CON_ID]				= @CON_ID, 
							[COU_NAME_EN]			= @COU_NAME_EN,
							[COU_NAME_BR]			= @COU_NAME_BR,
							[COU_ISO31661_ALPHA2]	= @COU_ISO31661_ALPHA2,
							[COU_ISO31661_ALPHA3]	= @COU_ISO31661_ALPHA3,
							[COU_ISO31661_NUMBER]	= @COU_ISO31661_NUMBER
						WHERE [COU_ISO31661_ALPHA3] = (@COU_ISO31661_ALPHA3);
					END
					ELSE IF (@COU_ISO31661_NUMBER IS NOT NULL)
					BEGIN
						UPDATE [dbo].[COUNTRY] 
						SET 
							[CON_ID]				= @CON_ID, 
							[COU_NAME_EN]			= @COU_NAME_EN,
							[COU_NAME_BR]			= @COU_NAME_BR,
							[COU_ISO31661_ALPHA2]	= @COU_ISO31661_ALPHA2,
							[COU_ISO31661_ALPHA3]	= @COU_ISO31661_ALPHA3,
							[COU_ISO31661_NUMBER]	= @COU_ISO31661_NUMBER
						WHERE [COU_ISO31661_NUMBER] = (@COU_ISO31661_NUMBER);
					END
					ELSE
					BEGIN
						PRINT ('ERRO UPDATE NULL COD.0006');
						RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO UPDATE NULL COD.0006') WITH LOG;
					END;
				END
				ELSE IF (@CRUD = (UPPER('delete')))
				BEGIN
					IF (@COU_ID IS NOT NULL)
					BEGIN
						DELETE [dbo].[COUNTRY] WHERE [COU_ID] = (@COU_ID);
					END
					ELSE IF (@CON_ID IS NOT NULL)
					BEGIN
						 DELETE [dbo].[COUNTRY] WHERE [CON_ID] = (@CON_ID);
					END
					ELSE IF (@COU_NAME_EN IS NOT NULL)
					BEGIN
						 DELETE [dbo].[COUNTRY] WHERE [COU_NAME_EN] = (@COU_NAME_EN);
					END
					ELSE IF (@COU_NAME_BR IS NOT NULL)
					BEGIN
						DELETE [dbo].[COUNTRY] WHERE [COU_NAME_BR] = (@COU_NAME_BR);
					END
					ELSE IF (@COU_ISO31661_ALPHA2 IS NOT NULL)
					BEGIN
						DELETE [dbo].[COUNTRY] WHERE [COU_ISO31661_ALPHA2] = (@COU_ISO31661_ALPHA2);
					END
					ELSE IF (@COU_ISO31661_ALPHA3 IS NOT NULL)
					BEGIN
						DELETE [dbo].[COUNTRY] WHERE [COU_ISO31661_ALPHA3] = (@COU_ISO31661_ALPHA3);
					END
					ELSE IF (@COU_ISO31661_NUMBER IS NOT NULL)
					BEGIN
						DELETE [dbo].[COUNTRY] WHERE [COU_ISO31661_NUMBER] = (@COU_ISO31661_NUMBER);
					END
					ELSE
					BEGIN
						PRINT ('ERRO DELETE NULL COD.0007');
						RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO DELETE NULL COD.0007') WITH LOG;
					END;
				END;
				IF ((@@TRANCOUNT) >= (1)) 
				BEGIN
					PRINT 'COMMIT TRANSACTION @TRANSACTION_COUNTRY_CRUD [  ]';
					COMMIT TRANSACTION @TRANSACTION_COUNTRY_CRUD;
					PRINT 'COMMIT TRANSACTION @TRANSACTION_COUNTRY_CRUD [OK]';
					SET @RESULT = (UPPER('SUCESSO'));
					RETURN (0);
				END
				ELSE
				BEGIN
					PRINT ('ERRO CRUD TRANSACTION @TRANSACTION_COUNTRY_CRUD COD.0009');
					RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO CRUD TRANSACTION @TRANSACTION_COUNTRY_CRUD COD.0009') WITH LOG;
				END;			
			END
			ELSE
			BEGIN
				PRINT ('ERRO CRUD COD.0003 - NOT ON LIST [dbo].[#CRUD_LIST_ARRAY_ONLY]');
				RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO CRUD COD.0003 - NOT ON LIST [dbo].[#CRUD_LIST_ARRAY_ONLY] COD.0003') WITH LOG;
			END;
		END
		ELSE 
		BEGIN
			PRINT ('ERRO CRUD COD.0002 - NULL');
			RAISERROR (15600,-1,-1, '[dbo].[COUNTRY_CRUD] - ERRO CRUD COD.0002 - NULL') WITH LOG;
			/*
				RAISERROR ('[dbo].[COUNTRY_CRUD]', 16, 1) WITH LOG;  
			*/
		END;
	END TRY
	BEGIN CATCH
		PRINT 'ERROR [  ] COD.0001';
		IF ((@@TRANCOUNT) >= (1)) 
		BEGIN
			PRINT 'ROLLBACK TRANSACTION @TRANSACTION_COUNTRY_CRUD [  ]';
				ROLLBACK TRANSACTION @TRANSACTION_COUNTRY_CRUD;
			PRINT 'ROLLBACK TRANSACTION @TRANSACTION_COUNTRY_CRUD [OK]';
		END;
		PRINT 'ERROR [OK] COD.0001';
		RETURN (1);
	END CATCH;
END;
	/*
		--SELECT CAST('FALSE' as bit) AS [FALSE]  -- RETURN 0 SUCESS
		--SELECT CAST('TRUE'  as bit) AS [TRUE]   -- RETURN 1 ERROR
	*/